#mutual information filter by class 
ClassMI <- function(data, class, threshold){
  require(infotheo)
  mi_scores <- sapply(data, function(x) mutinformation(x, as.factor(class)))
  selected_features <- list(scores=mi_scores,sel.features=names(mi_scores[mi_scores != threshold]))
  return(selected_features)
}





# filter out outliers by class using tidyverse!
require(rstatix)
data %>%
  select(class, where(is.numeric)) %>% 
  group_by(class) %>%
  mutate_at(vars(-class), ~ifelse(is_outlier(., coef = 2.5), NA, .)) %>%
  ungroup() %>%
  na.omit()


#scale data by class using tidyverse!
data %>% 
  group_by(class) %>%
  mutate_at(vars(-class),list(~ scale(.))) %>% 
  ungroup()



#relevel factor levels of a df into numebers and booleans for LCA
data %>%
  mutate(across(.cols = everything(), .fns = ~as.integer(factor(.))) %>%
           mutate(across(.cols = everything(), .fns = ~if_else(. == 0, 1, .))))











